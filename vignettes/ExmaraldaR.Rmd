---
title: "Importing annotated EXMARaLDA transcripts with ExmaraldaR"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ExmaraldaR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE, echo=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, include=FALSE}
library(devtools)
install_github("TimoSchuer/ExmaraldaR", force = TRUE)
library(ExmaraldaR)
library(knitr)

```
This package was developed to import transcripts of spoken language created with EXMARALDA (ADD CITATION) into R in a comfortable and fast way. First there will be some comments on how EXMARaLDA works and how transcription and annotation must be formatted to be easily readable. As I try to include more ways of transcribing and annotating data into this package, please write to me if your style does not work yet (timo.schuermann@uni-muenster.de).  

## Transcribing and annotating in EXMARaLDA

EXMARaLDA is a software package developed and maintained by Thomas Schmidt. Besides the transcription and annotation tool Partitur Editor, it includes a tool for managing corpora(Corpus-Manager) and a tool for searching and analysing (EXAKT). This package only contains a interface between R and the .exb format of the Partitur Editor. Maybe there will be options for segmetented files (.exs). Partitur Editor saves transcritions as an xml-based data format, which makes it possible to extract all relevant informations into a data table.
As this is can not be an extensive introduction in the EXMARaLDA-Software package i will in the forthgoing assume that the users of this package know:

1. how to create a transcription
2. how allign audio/video data and transcrition
3. how to transcribe 
4. how to annotate a transcription (including allinging)

In the following I will consider some features of the work process that lead to a well formed R- object. I will therefore go backwards, showing you the output of example files and then the parameter in the Partitur Editor leading to this specific output.

```{r eval=FALSE}
path <- system.file("extdata", "Example_linear.exb", package = "ExmaraldaR", mustWork = TRUE)
read_exb_file(path, readAnn = TRUE, annotation= "linear", addMetaData = TRUE)
```
```{r echo=FALSE, results='asis', warning=FALSE}
path <- system.file("extdata", "Example_linear.exb", package = "ExmaraldaR", mustWork = TRUE)
example <- read_exb_file(path, readAnn = TRUE, annotation= "linear", addMetaData = TRUE)
kable(example)
```

This is the table froma an annotated exb. file using a linear annotation putting serveral information in just one tag (see further below). So lets have a look at the different columns and the information they contain.

### IP Number 

The first row contains a IP numbering based on the intonation phrase in GAT2 (ZITATION). It uses the set of delimiters as the signs for intonation at the end of a phrase or the neutral "|". If there are overlapping speech events, the one starting first gets the lower number.

### File

The name of the file. Important if more than one file (via read_exb_dir()) is imported.

### Speaker

Speaker sigle as named in the speaker table (see below).

### Tier ID

ID of each tier. Just important for files creating .exb files as add_min_tier() or write_back_to_exb()

### Name

Name of the speaker.

### Text 

Transcription text divided into events as in the Partitur Editor.

### Metadata

Some additional information about the speaker added via the Speaker table. In this example file it is sex, languages used, L1, L2, comment and age.

### Start and End of event

Contains the end and start in the timeline of an event. Just important for files creating .exb files as add_min_tier() or write_back_to_exb().

### Annotations

This is sorted version of the annotated data.

So the dataframe contains every information that could be useful for further analysis. And also some information thats only useful if you for example change something in the R data frame or excel file and want the data to be consistent to the exb files and therefore write it back.

In the next step we will look at the options in the speakertable that lead to the metadata columns.


## Metadata

![](C:\Users\Admin\sciebo\R\Kookkurrenz\Paket\metadata.png)
In some point of your transcription process you have to create speaker via the speakertable (Transcription > Speakertable). In Sektion (1) there are fixed attributes. This includes speakerabbrevation (presented in the column 'speaker'), sex and languages. In section (2) you can leave additional comments to the speaker. For most analytical puporses it can be useful to define some person related information to include it into the analysis or subset your data to certain groups. The name of the self defined attributes will be the name of the column. All Information set here can be included or excluded from the dataframe with the parameter *addMetaData*.

## Linear annotation

With the (probably incorrect) term linear annotation i mean a 
